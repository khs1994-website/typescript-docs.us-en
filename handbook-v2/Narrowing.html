
<!DOCTYPE HTML>
<html lang="us-en" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Narrowing · TypeScript 英文文档</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-prism/prism-solarizedlight.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="Object Types.html" />
    
    
    <link rel="prev" href="More on Functions.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    
    
        
        <li>
            <a href="https://docs.khs1994.com" target="_blank" class="custom-link">Home</a>
        </li>
    
    

    
    <li class="divider"></li>
    

    
        
        
    
        <li class="chapter " data-level="1.1" >
            
                <span>
            
                    
                    Declaration Files
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.1.1" >
            
                <span>
            
                    
                    Templates
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.1.1.1" data-path="../declaration-files/templates/global-modifying-module.d.ts.html">
            
                <a href="../declaration-files/templates/global-modifying-module.d.ts.html">
            
                    
                    Global Modifying Module
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.1.1.2" data-path="../declaration-files/templates/global-plugin.d.ts.html">
            
                <a href="../declaration-files/templates/global-plugin.d.ts.html">
            
                    
                    Global Plugin
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.1.1.3" data-path="../declaration-files/templates/global.d.ts.html">
            
                <a href="../declaration-files/templates/global.d.ts.html">
            
                    
                    Global .d.ts
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.1.1.4" data-path="../declaration-files/templates/module-class.d.ts.html">
            
                <a href="../declaration-files/templates/module-class.d.ts.html">
            
                    
                    Module Class
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.1.1.5" data-path="../declaration-files/templates/module-function.d.ts.html">
            
                <a href="../declaration-files/templates/module-function.d.ts.html">
            
                    
                    Module Function
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.1.1.6" data-path="../declaration-files/templates/module-plugin.d.ts.html">
            
                <a href="../declaration-files/templates/module-plugin.d.ts.html">
            
                    
                    Module Plugin
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.1.1.7" data-path="../declaration-files/templates/module.d.ts.html">
            
                <a href="../declaration-files/templates/module.d.ts.html">
            
                    
                    Modules .d.ts
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.1.2" data-path="../declaration-files/By Example.html">
            
                <a href="../declaration-files/By Example.html">
            
                    
                    Declaration Reference
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.1.3" data-path="../declaration-files/Consumption.html">
            
                <a href="../declaration-files/Consumption.html">
            
                    
                    Consumption
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.1.4" data-path="../declaration-files/Deep Dive.html">
            
                <a href="../declaration-files/Deep Dive.html">
            
                    
                    Deep Dive
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.1.5" data-path="../declaration-files/Do's and Don'ts.html">
            
                <a href="../declaration-files/Do's and Don'ts.html">
            
                    
                    Do S And Don Ts
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.1.6" data-path="../declaration-files/Introduction.html">
            
                <a href="../declaration-files/Introduction.html">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.1.7" data-path="../declaration-files/Library Structures.html">
            
                <a href="../declaration-files/Library Structures.html">
            
                    
                    Library Structures
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.1.8" data-path="../declaration-files/Publishing.html">
            
                <a href="../declaration-files/Publishing.html">
            
                    
                    Publishing
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.1.9" data-path="../declaration-files/Templates.html">
            
                <a href="../declaration-files/Templates.html">
            
                    
                    Templates
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2" >
            
                <span>
            
                    
                    Get Started
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../get-started/TS for Functional Programmers.html">
            
                <a href="../get-started/TS for Functional Programmers.html">
            
                    
                    Type Script For Functional Programmers
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="../get-started/TS for JS Programmers.html">
            
                <a href="../get-started/TS for JS Programmers.html">
            
                    
                    Type Script For Java Script Programmers
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3" data-path="../get-started/TS for OOPers.html">
            
                <a href="../get-started/TS for OOPers.html">
            
                    
                    Type Script For Java C Programmers
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4" data-path="../get-started/TS for the New Programmer.html">
            
                <a href="../get-started/TS for the New Programmer.html">
            
                    
                    Type Script For The New Programmer
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" >
            
                <span>
            
                    
                    Handbook V 1
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="../handbook-v1/Basic Types.html">
            
                <a href="../handbook-v1/Basic Types.html">
            
                    
                    Basic Types
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="../handbook-v1/Classes.html">
            
                <a href="../handbook-v1/Classes.html">
            
                    
                    Classes
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="../handbook-v1/Functions.html">
            
                <a href="../handbook-v1/Functions.html">
            
                    
                    Functions
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4" data-path="../handbook-v1/Generics.html">
            
                <a href="../handbook-v1/Generics.html">
            
                    
                    Generics
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.5" data-path="../handbook-v1/Interfaces.html">
            
                <a href="../handbook-v1/Interfaces.html">
            
                    
                    Interfaces
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.6" data-path="../handbook-v1/Literal Types.html">
            
                <a href="../handbook-v1/Literal Types.html">
            
                    
                    Literal Types
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.7" data-path="../handbook-v1/Unions and Intersections.html">
            
                <a href="../handbook-v1/Unions and Intersections.html">
            
                    
                    Unions And Intersection Types
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" >
            
                <span>
            
                    
                    Handbook V 2
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" >
            
                <span>
            
                    
                    Type Manipulation
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1.1" data-path="Type Manipulation/_Creating Types from Types.html">
            
                <a href="Type Manipulation/_Creating Types from Types.html">
            
                    
                    Creating Types From Types
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.1.2" data-path="Type Manipulation/Conditional Types.html">
            
                <a href="Type Manipulation/Conditional Types.html">
            
                    
                    Conditional Types
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.1.3" data-path="Type Manipulation/Generics.html">
            
                <a href="Type Manipulation/Generics.html">
            
                    
                    Generics
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.1.4" data-path="Type Manipulation/Indexed Access Types.html">
            
                <a href="Type Manipulation/Indexed Access Types.html">
            
                    
                    Indexed Access Types
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.1.5" data-path="Type Manipulation/Keyof Type Operator.html">
            
                <a href="Type Manipulation/Keyof Type Operator.html">
            
                    
                    Keyof Type Operator
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.1.6" data-path="Type Manipulation/Mapped Types.html">
            
                <a href="Type Manipulation/Mapped Types.html">
            
                    
                    Mapped Types
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.1.7" data-path="Type Manipulation/Template Literal Types.html">
            
                <a href="Type Manipulation/Template Literal Types.html">
            
                    
                    Template Literal Types
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.1.8" data-path="Type Manipulation/Typeof Type Operator.html">
            
                <a href="Type Manipulation/Typeof Type Operator.html">
            
                    
                    Typeof Type Operator
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="Basics.html">
            
                <a href="Basics.html">
            
                    
                    The Basics
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="Classes.html">
            
                <a href="Classes.html">
            
                    
                    Classes
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4" data-path="Everyday Types.html">
            
                <a href="Everyday Types.html">
            
                    
                    Everyday Types
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.5" data-path="Modules.html">
            
                <a href="Modules.html">
            
                    
                    Modules
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.6" data-path="More on Functions.html">
            
                <a href="More on Functions.html">
            
                    
                    More On Functions
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.4.7" data-path="Narrowing.html">
            
                <a href="Narrowing.html">
            
                    
                    Narrowing
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.8" data-path="Object Types.html">
            
                <a href="Object Types.html">
            
                    
                    Object Types
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.9" data-path="The Handbook.html">
            
                <a href="The Handbook.html">
            
                    
                    The Type Script Handbook
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.10" data-path="Type Declarations.html">
            
                <a href="Type Declarations.html">
            
                    
                    Type Declarations
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.11" data-path="Understanding Errors.html">
            
                <a href="Understanding Errors.html">
            
                    
                    Understanding Errors
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" >
            
                <span>
            
                    
                    Javascript
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="../javascript/Creating DTS files From JS.html">
            
                <a href="../javascript/Creating DTS files From JS.html">
            
                    
                    Creating .d.ts Files from .js files
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="../javascript/Intro to JS with TS.html">
            
                <a href="../javascript/Intro to JS with TS.html">
            
                    
                    JS Projects Utilizing Type Script
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3" data-path="../javascript/JSDoc Reference.html">
            
                <a href="../javascript/JSDoc Reference.html">
            
                    
                    JS Doc Reference
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4" data-path="../javascript/Type Checking JavaScript Files.html">
            
                <a href="../javascript/Type Checking JavaScript Files.html">
            
                    
                    Type Checking Java Script Files
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" >
            
                <span>
            
                    
                    Project Config
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="../project-config/Compiler Options in MSBuild.html">
            
                <a href="../project-config/Compiler Options in MSBuild.html">
            
                    
                    Compiler Options In MS Build
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2" data-path="../project-config/Compiler Options.html">
            
                <a href="../project-config/Compiler Options.html">
            
                    
                    Tsc CLI Options
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.3" data-path="../project-config/Configuring Watch.html">
            
                <a href="../project-config/Configuring Watch.html">
            
                    
                    Configuring Watch
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.4" data-path="../project-config/Integrating with Build Tools.html">
            
                <a href="../project-config/Integrating with Build Tools.html">
            
                    
                    Integrating With Build Tools
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.5" data-path="../project-config/Project References.html">
            
                <a href="../project-config/Project References.html">
            
                    
                    Project References
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.6" data-path="../project-config/tsconfig.json.html">
            
                <a href="../project-config/tsconfig.json.html">
            
                    
                    What is a tsconfig.json
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7" >
            
                <span>
            
                    
                    Reference
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.1" data-path="../reference/Advanced Types.html">
            
                <a href="../reference/Advanced Types.html">
            
                    
                    Advanced Types
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.2" data-path="../reference/Declaration Merging.html">
            
                <a href="../reference/Declaration Merging.html">
            
                    
                    Declaration Merging
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.3" data-path="../reference/Decorators.html">
            
                <a href="../reference/Decorators.html">
            
                    
                    Decorators
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.4" data-path="../reference/Enums.html">
            
                <a href="../reference/Enums.html">
            
                    
                    Enums
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.5" data-path="../reference/Iterators and Generators.html">
            
                <a href="../reference/Iterators and Generators.html">
            
                    
                    Iterators And Generators
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.6" data-path="../reference/JSX.html">
            
                <a href="../reference/JSX.html">
            
                    
                    JSX
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.7" data-path="../reference/Mixins.html">
            
                <a href="../reference/Mixins.html">
            
                    
                    Mixins
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.8" data-path="../reference/Module Resolution.html">
            
                <a href="../reference/Module Resolution.html">
            
                    
                    Module Resolution
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.9" data-path="../reference/Modules.html">
            
                <a href="../reference/Modules.html">
            
                    
                    Modules
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.10" data-path="../reference/Namespaces and Modules.html">
            
                <a href="../reference/Namespaces and Modules.html">
            
                    
                    Namespaces And Modules
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.11" data-path="../reference/Namespaces.html">
            
                <a href="../reference/Namespaces.html">
            
                    
                    Namespaces
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.12" data-path="../reference/Symbols.html">
            
                <a href="../reference/Symbols.html">
            
                    
                    Symbols
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.13" data-path="../reference/Triple-Slash Directives.html">
            
                <a href="../reference/Triple-Slash Directives.html">
            
                    
                    Triple Slash Directives
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.14" data-path="../reference/Type Compatibility.html">
            
                <a href="../reference/Type Compatibility.html">
            
                    
                    Type Compatibility
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.15" data-path="../reference/Type Inference.html">
            
                <a href="../reference/Type Inference.html">
            
                    
                    Type Inference
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.16" data-path="../reference/Utility Types.html">
            
                <a href="../reference/Utility Types.html">
            
                    
                    Utility Types
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.17" data-path="../reference/Variable Declarations.html">
            
                <a href="../reference/Variable Declarations.html">
            
                    
                    Variable Declaration
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8" >
            
                <span>
            
                    
                    Release Notes
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.1" data-path="../release-notes/Overview.html">
            
                <a href="../release-notes/Overview.html">
            
                    
                    Overview
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2" data-path="../release-notes/TypeScript 1.1.html">
            
                <a href="../release-notes/TypeScript 1.1.html">
            
                    
                    TypeScript 1.1
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.3" data-path="../release-notes/TypeScript 1.3.html">
            
                <a href="../release-notes/TypeScript 1.3.html">
            
                    
                    TypeScript 1.3
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.4" data-path="../release-notes/TypeScript 1.4.html">
            
                <a href="../release-notes/TypeScript 1.4.html">
            
                    
                    TypeScript 1.4
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.5" data-path="../release-notes/TypeScript 1.5.html">
            
                <a href="../release-notes/TypeScript 1.5.html">
            
                    
                    TypeScript 1.5
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.6" data-path="../release-notes/TypeScript 1.6.html">
            
                <a href="../release-notes/TypeScript 1.6.html">
            
                    
                    TypeScript 1.6
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.7" data-path="../release-notes/TypeScript 1.7.html">
            
                <a href="../release-notes/TypeScript 1.7.html">
            
                    
                    TypeScript 1.7
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.8" data-path="../release-notes/TypeScript 1.8.html">
            
                <a href="../release-notes/TypeScript 1.8.html">
            
                    
                    TypeScript 1.8
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.9" data-path="../release-notes/TypeScript 2.0.html">
            
                <a href="../release-notes/TypeScript 2.0.html">
            
                    
                    TypeScript 2.0
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.10" data-path="../release-notes/TypeScript 2.1.html">
            
                <a href="../release-notes/TypeScript 2.1.html">
            
                    
                    TypeScript 2.1
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.11" data-path="../release-notes/TypeScript 2.2.html">
            
                <a href="../release-notes/TypeScript 2.2.html">
            
                    
                    TypeScript 2.2
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.12" data-path="../release-notes/TypeScript 2.3.html">
            
                <a href="../release-notes/TypeScript 2.3.html">
            
                    
                    TypeScript 2.3
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.13" data-path="../release-notes/TypeScript 2.4.html">
            
                <a href="../release-notes/TypeScript 2.4.html">
            
                    
                    TypeScript 2.4
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.14" data-path="../release-notes/TypeScript 2.5.html">
            
                <a href="../release-notes/TypeScript 2.5.html">
            
                    
                    TypeScript 2.5
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.15" data-path="../release-notes/TypeScript 2.6.html">
            
                <a href="../release-notes/TypeScript 2.6.html">
            
                    
                    TypeScript 2.6
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.16" data-path="../release-notes/TypeScript 2.7.html">
            
                <a href="../release-notes/TypeScript 2.7.html">
            
                    
                    TypeScript 2.7
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.17" data-path="../release-notes/TypeScript 2.8.html">
            
                <a href="../release-notes/TypeScript 2.8.html">
            
                    
                    TypeScript 2.8
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.18" data-path="../release-notes/TypeScript 2.9.html">
            
                <a href="../release-notes/TypeScript 2.9.html">
            
                    
                    TypeScript 2.9
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.19" data-path="../release-notes/TypeScript 3.0.html">
            
                <a href="../release-notes/TypeScript 3.0.html">
            
                    
                    TypeScript 3.0
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.20" data-path="../release-notes/TypeScript 3.1.html">
            
                <a href="../release-notes/TypeScript 3.1.html">
            
                    
                    TypeScript 3.1
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.21" data-path="../release-notes/TypeScript 3.2.html">
            
                <a href="../release-notes/TypeScript 3.2.html">
            
                    
                    TypeScript 3.2
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.22" data-path="../release-notes/TypeScript 3.3.html">
            
                <a href="../release-notes/TypeScript 3.3.html">
            
                    
                    TypeScript 3.3
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.23" data-path="../release-notes/TypeScript 3.4.html">
            
                <a href="../release-notes/TypeScript 3.4.html">
            
                    
                    TypeScript 3.4
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.24" data-path="../release-notes/TypeScript 3.5.html">
            
                <a href="../release-notes/TypeScript 3.5.html">
            
                    
                    TypeScript 3.5
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.25" data-path="../release-notes/TypeScript 3.6.html">
            
                <a href="../release-notes/TypeScript 3.6.html">
            
                    
                    TypeScript 3.6
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.26" data-path="../release-notes/TypeScript 3.7.html">
            
                <a href="../release-notes/TypeScript 3.7.html">
            
                    
                    TypeScript 3.7
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.27" data-path="../release-notes/TypeScript 3.8.html">
            
                <a href="../release-notes/TypeScript 3.8.html">
            
                    
                    TypeScript 3.8
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.28" data-path="../release-notes/TypeScript 3.9.html">
            
                <a href="../release-notes/TypeScript 3.9.html">
            
                    
                    TypeScript 3.9
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.29" data-path="../release-notes/TypeScript 4.0.html">
            
                <a href="../release-notes/TypeScript 4.0.html">
            
                    
                    TypeScript 4.0
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.30" data-path="../release-notes/TypeScript 4.1.html">
            
                <a href="../release-notes/TypeScript 4.1.html">
            
                    
                    TypeScript 4.1
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.31" data-path="../release-notes/TypeScript 4.2.html">
            
                <a href="../release-notes/TypeScript 4.2.html">
            
                    
                    TypeScript 4.2
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.9" >
            
                <span>
            
                    
                    Tutorials
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.9.1" data-path="../tutorials/Angular.html">
            
                <a href="../tutorials/Angular.html">
            
                    
                    Angular
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.2" data-path="../tutorials/ASP.NET Core.html">
            
                <a href="../tutorials/ASP.NET Core.html">
            
                    
                    ASP.NET Core
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.3" data-path="../tutorials/Babel with TypeScript.html">
            
                <a href="../tutorials/Babel with TypeScript.html">
            
                    
                    Using Babel With Type Script
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.4" data-path="../tutorials/DOM Manipulation.html">
            
                <a href="../tutorials/DOM Manipulation.html">
            
                    
                    DOM Manipulation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.5" data-path="../tutorials/Gulp.html">
            
                <a href="../tutorials/Gulp.html">
            
                    
                    Gulp
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.6" data-path="../tutorials/Migrating from JavaScript.html">
            
                <a href="../tutorials/Migrating from JavaScript.html">
            
                    
                    Migrating From Java Script
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.7" data-path="../tutorials/React.html">
            
                <a href="../tutorials/React.html">
            
                    
                    React
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.8" data-path="../tutorials/TypeScript Tooling in 5 minutes.html">
            
                <a href="../tutorials/TypeScript Tooling in 5 minutes.html">
            
                    
                    Type Script Tooling In 5 Minutes
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.10" data-path="../Nightly Builds.html">
            
                <a href="../Nightly Builds.html">
            
                    
                    Nightly Builds
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11" data-path="../">
            
                <a href="../">
            
                    
                    Type Script Tooling In 5 Minutes
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >Narrowing</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <p>Imagine we have a function called <code>padLeft</code>.</p>
<p>```ts twoslash
function padLeft(padding: number | string, input: string): string {
  throw new Error(&quot;Not implemented yet!&quot;);
}</p>
<pre class="language-"><code>
If `padding` is a `number`, it will treat that as the number of spaces we want to prepend to `input`.
If `padding` is a `string`, it should just prepend `padding` to `input`.
Let&apos;s try to implement the logic for when `padLeft` is passed a `number` for `padding`.

```ts twoslash
// @errors: 2365
function padLeft(padding: number | string, input: string) {
  return new Array(padding + 1).join(&quot; &quot;) + input;
}
</code></pre><p>Uh-oh, we&apos;re getting an error on <code>padding + 1</code>.
TypeScript is warning us that adding a <code>number</code> to a <code>number | string</code> might not give us what we want, and it&apos;s right.
In other words, we haven&apos;t explicitly checked if <code>padding</code> is a <code>number</code> first, nor are we handling the case where it&apos;s a <code>string</code>, so let&apos;s do exactly that.</p>
<p>```ts twoslash
function padLeft(padding: number | string, input: string) {
  if (typeof padding === &quot;number&quot;) {
    return new Array(padding + 1).join(&quot; &quot;) + input;
  }
  return padding + input;
}</p>
<pre class="language-"><code>
If this mostly looks like uninteresting JavaScript code, that&apos;s sort of the point.
Apart from the annotations we put in place, this TypeScript code looks like JavaScript.
The idea is that TypeScript&apos;s type system aims to make it as easy as possible to write typical JavaScript code without bending over backwards to get type safety.

While it might not look like much, there&apos;s actually a lot going under the covers here.
Much like how TypeScript analyzes runtime values using static types, it overlays type analysis on JavaScript&apos;s runtime control flow constructs like `if/else`, conditional ternaries, loops, truthiness checks, etc., which can all affect those types.

Within our `if` check, TypeScript sees `typeof padding === &quot;number&quot;` and understands that as a special form of code called a _type guard_.
TypeScript follows possible paths of execution that our programs can take to analyze the most specific possible type of a value at a given position.
It looks at these special checks (called _type guards_) and assignments, and the process of refining types to more specific types than declared is called _narrowing_.
In many editors we can observe these types as they change, and we&apos;ll even do so in our examples.

```ts twoslash
function padLeft(padding: number | string, input: string) {
  if (typeof padding === &quot;number&quot;) {
    return new Array(padding + 1).join(&quot; &quot;) + input;
    //               ^?
  }
  return padding + input;
  //     ^?
}
</code></pre><p>There are a couple of different constructs TypeScript understands for narrowing.</p>
<h2 id="typeof-type-guards"><code>typeof</code> type guards</h2>
<p>As we&apos;ve seen, JavaScript supports a <code>typeof</code> operator which can give very basic information about the type of values we have at runtime.
TypeScript expects this to return a certain set of strings:</p>
<ul>
<li><code>&quot;string&quot;</code></li>
<li><code>&quot;number&quot;</code></li>
<li><code>&quot;bigint&quot;</code></li>
<li><code>&quot;boolean&quot;</code></li>
<li><code>&quot;symbol&quot;</code></li>
<li><code>&quot;undefined&quot;</code></li>
<li><code>&quot;object&quot;</code></li>
<li><code>&quot;function&quot;</code></li>
</ul>
<p>Like we saw with <code>padLeft</code>, this operator comes up pretty often in a number of JavaScript libraries, and TypeScript can understand it to narrow types in different branches.</p>
<p>In TypeScript, checking against the value returned by <code>typeof</code> is a type guard.
Because TypeScript encodes how <code>typeof</code> operates on different values, it knows about some of its quirks in JavaScript.
For example, notice that in the list above, <code>typeof</code> doesn&apos;t return the string <code>null</code>.
Check out the following example:</p>
<p>```ts twoslash
// @errors: 2531
function printAll(strs: string | string[] | null) {
  if (typeof strs === &quot;object&quot;) {
    for (const s of strs) {
      console.log(s);
    }
  } else if (typeof strs === &quot;string&quot;) {
    console.log(strs);
  } else {
    // do nothing
  }
}</p>
<pre class="language-"><code>
In the `printAll` function, we try to check if `strs` is an object to see if it&apos;s an array type (now might be a good time to reinforce that arrays are object types in JavaScript).
But it turns out that in JavaScript, `typeof null` is actually `&quot;object&quot;`!
This is one of those unfortunate accidents of history.

Users with enough experience might not be surprised, but not everyone has run into this in JavaScript; luckily, TypeScript lets us know that `strs` was only narrowed down to `string[] | null` instead of just `string[]`.

This might be a good segue into what we&apos;ll call &quot;truthiness&quot; checking.

# Truthiness narrowing

Truthiness might not be a word you&apos;ll find in the dictionary, but it&apos;s very much something you&apos;ll hear about in JavaScript.

In JavaScript, we can use any expression in conditionals, `&amp;&amp;`s, `||`s, `if` statements, and Boolean negations (`!`), and more.
As an example, `if` statements don&apos;t expect their condition to always have the type `boolean`.

```ts twoslash
function getUsersOnlineMessage(numUsersOnline: number) {
  if (numUsersOnline) {
    return `There are ${numUsersOnline} online now!`;
  }
  return &quot;Nobody&apos;s here. :(&quot;;
}
</code></pre><p>In JavaScript, constructs like <code>if</code> first &quot;coerce&quot; their conditions to <code>boolean</code>s to make sense of them, and then choose their branches depending on whether the result is <code>true</code> or <code>false</code>.
Values like</p>
<ul>
<li><code>0</code></li>
<li><code>NaN</code></li>
<li><code>&quot;&quot;</code> (the empty string)</li>
<li><code>0n</code> (the <code>bigint</code> version of zero)</li>
<li><code>null</code></li>
<li><code>undefined</code></li>
</ul>
<p>all coerce to <code>false</code>, and other values get coerced <code>true</code>.
You can always coerce values to <code>boolean</code>s by running them through the <code>Boolean</code> function, or by using the shorter double-Boolean negation.</p>
<p>```ts twoslash
// both of these result in &apos;true&apos;
Boolean(&quot;hello&quot;);
!!&quot;world&quot;;</p>
<pre class="language-"><code>
It&apos;s fairly popular to leverage this behavior, especially for guarding against values like `null` or `undefined`.
As an example, let&apos;s try using it for our `printAll` function.

```ts twoslash
function printAll(strs: string | string[] | null) {
  if (strs &amp;&amp; typeof strs === &quot;object&quot;) {
    for (const s of strs) {
      console.log(s);
    }
  } else if (typeof strs === &quot;string&quot;) {
    console.log(strs);
  }
}
</code></pre><p>You&apos;ll notice that we&apos;ve gotten rid of the error above by checking if <code>strs</code> is truthy.
This at least prevents us from dreaded errors when we run our code like:</p>
<pre class="language-"><code class="lang-txt">TypeError: null is not iterable
</code></pre>
<p>Keep in mind though that truthiness checking on primitives can often be error prone.
As an example, consider a different attempt at writing <code>printAll</code></p>
<p>```ts twoslash {class: &quot;do-not-do-this&quot;}
function printAll(strs: string | string[] | null) {
  // !!!!!!!!!!!!!!!!
  //  DON&apos;T DO THIS!
  //   KEEP READING
  // !!!!!!!!!!!!!!!!
  if (strs) {
    if (typeof strs === &quot;object&quot;) {
      for (const s of strs) {
        console.log(s);
      }
    } else if (typeof strs === &quot;string&quot;) {
      console.log(strs);
    }
  }
}</p>
<pre class="language-"><code>
We wrapped the entire body of the function in a truthy check, but this has a subtle downside: we may no longer be handling the empty string case correctly.

TypeScript doesn&apos;t hurt us here at all, but this is behavior worth noting if you&apos;re less familiar with JavaScript.
TypeScript can often help you catch bugs early on, but if you choose to do _nothing_ with a value, there&apos;s only so much that it can do without being overly prescriptive.
If you want, you can make sure you handle situations like these with a linter.

One last word on narrowing by truthiness is that Boolean negations with `!` filter out from negated branches.

```ts twoslash
function multiplyAll(
  values: number[] | undefined,
  factor: number
): number[] | undefined {
  if (!values) {
    return values;
  } else {
    return values.map((x) =&gt; x * factor);
  }
}
</code></pre><h2 id="equality-narrowing">Equality narrowing</h2>
<p>TypeScript also uses <code>switch</code> statements and equality checks like <code>===</code>, <code>!==</code>, <code>==</code>, and <code>!=</code> to narrow types.
For example:</p>
<p>```ts twoslash
function example(x: string | number, y: string | boolean) {
  if (x === y) {
    // We can now call any &apos;string&apos; method on &apos;x&apos; or &apos;y&apos;.
    x.toUpperCase();
    // ^?
    y.toLowerCase();
    // ^?
  } else {
    console.log(x);
    //          ^?
    console.log(y);
    //          ^?
  }
}</p>
<pre class="language-"><code>
When we checked that `x` and `y` are both equal in the above example, TypeScript knew their types also had to be equal.
Since `string` is the only common type that both `x` and `y` could take on, TypeScript knows that `x` and `y` must be a `string` in the first branch.

Checking against specific literal values (as opposed to variables) works also.
In our section about truthiness narrowing, we wrote a `printAll` function which was error-prone because it accidentally didn&apos;t handle empty strings properly.
Instead we could have done a specific check to block out `null`s, and TypeScript still correctly removes `null` from the type of `strs`.

```ts twoslash
function printAll(strs: string | string[] | null) {
  if (strs !== null) {
    if (typeof strs === &quot;object&quot;) {
      for (const s of strs) {
        //            ^?
        console.log(s);
      }
    } else if (typeof strs === &quot;string&quot;) {
      console.log(strs);
      //          ^?
    }
  }
}
</code></pre><p>JavaScript&apos;s looser equality checks with <code>==</code> and <code>!=</code> also get narrowed correctly.
If you&apos;re unfamiliar, checking whether something <code>== null</code> actually not only checks whether it is specifically the value <code>null</code> - it also checks whether it&apos;s potentially <code>undefined</code>.
The same applies to <code>== undefined</code>: it checks whether a value is either <code>null</code> or <code>undefined</code>.</p>
<p>```ts twoslash
interface Container {
  value: number | null | undefined;
}</p>
<p>function multiplyValue(container: Container, factor: number) {
  // Remove both &apos;null&apos; and &apos;undefined&apos; from the type.
  if (container.value != null) {
    console.log(container.value);
    //                    ^?</p>
<pre class="language-"><code>// Now we can safely multiply &apos;container.value&apos;.
container.value *= factor;
</code></pre><p>  }
}</p>
<pre class="language-"><code>
### The `in` operator narrowing

Javascript has an operator for determining if an object has a property with a name: the `in` operator.
TypeScript takes this into account as a way to narrow down potential types.

For example, with the code: `&quot;value&quot; in x`.  where `&quot;value&quot;` is a string literal and `x` is a union type. 
The &quot;true&quot; branch narrows `x`&apos;s types which have either an optional or required property `value`, and the &quot;false&quot; branch narrows to types which have an optional or missing property `value`.

```ts twoslash
type Fish = { swim: () =&gt; void };
type Bird = { fly: () =&gt; void };

function move(animal: Fish | Bird) {
  if (&quot;swim&quot; in animal) {
    return animal.swim();
  }

  return animal.fly();
}
</code></pre><p>To re-iterate optional properties will exist in both sides for narrowing, for example a human could both swim and fly (with the right equipment) and thus should show up in both sides of the <code>in</code> check:</p>
<p>```ts twoslash
type Fish = { swim: () =&gt; void };
type Bird = { fly: () =&gt; void };
type Human = {  swim?: () =&gt; void, fly?: () =&gt; void };</p>
<p>function move(animal: Fish | Bird | Human) {
  if (&quot;swim&quot; in animal) { 
    animal
//  ^?
  } else {
    animal
//  ^?
  }
}</p>
<pre class="language-"><code>
## `instanceof` narrowing

JavaScript has an operator for checking whether or not a value is an &quot;instance&quot; of another value.
More specifically, in JavaScript `x instanceof Foo` checks whether the _prototype chain_ of `x` contains `Foo.prototype`.
While we won&apos;t dive deep here, and you&apos;ll see more of this when we get into classes, they can still be useful for most values that can be constructed with `new`.
As you might have guessed, `instanceof` is also a type guard, and TypeScript narrows in branches guarded by `instanceof`s.

```ts twoslash
function logValue(x: Date | string) {
  if (x instanceof Date) {
    console.log(x.toUTCString());
    //          ^?
  } else {
    console.log(x.toUpperCase());
    //          ^?
  }
}
</code></pre><h2 id="assignments">Assignments</h2>
<p>As we mentioned earlier, when we assign to any variable, TypeScript looks at the right side of the assignment and narrows the left side appropriately.</p>
<p>```ts twoslash
let x = Math.random() &lt; 0.5 ? 10 : &quot;hello world!&quot;;
//  ^?
x = 1;</p>
<p>console.log(x);
//          ^?
x = &quot;goodbye!&quot;;</p>
<p>console.log(x);
//          ^?</p>
<pre class="language-"><code>
Notice that each of these assignments is valid.
Even though the observed type of `x` changed to `number` after our first assignment, we were still able to assign a `string` to `x`.
This is because the _declared type_ of `x` - the type that `x` started with - is `string | number`, and assignability is always checked against the declared type.

If we&apos;d assigned a `boolean` to `x`, we&apos;d have seen an error since that wasn&apos;t part of the declared type.

```ts twoslash
// @errors: 2322
let x = Math.random() &lt; 0.5 ? 10 : &quot;hello world!&quot;;
//  ^?
x = 1;

console.log(x);
//          ^?
x = true;

console.log(x);
//          ^?
</code></pre><h2 id="control-flow-analysis">Control flow analysis</h2>
<p>Up until this point, we&apos;ve gone through some basic examples of how TypeScript narrows within specific branches.
But there&apos;s a bit more going on than just walking up from every variable and looking for type guards in <code>if</code>s, <code>while</code>s, conditionals, etc.
For example</p>
<p>```ts twoslash
function padLeft(padding: number | string, input: string) {
  if (typeof padding === &quot;number&quot;) {
    return new Array(padding + 1).join(&quot; &quot;) + input;
  }
  return padding + input;
}</p>
<pre class="language-"><code>
`padLeft` returns from within its first `if` block.
TypeScript was able to analyze this code and see that the rest of the body (`return padding + input;`) is _unreachable_ in the case where `padding` is a `number`.
As a result, it was able to remove `number` from the type of `padding` (narrowing from `string | number` to `string`) for the rest of the function.

This analysis of code based on reachability is called _control flow analysis_, and TypeScript uses this flow analysis to narrow types as it encounters type guards and assignments.
When a variable is analyzed, control flow can split off and re-merge over and over again, and that variable can be observed to have a different type at each point.

```ts twoslash
function example() {
  let x: string | number | boolean;

  x = Math.random() &lt; 0.5;

  console.log(x);
  //          ^?

  if (Math.random() &lt; 0.5) {
    x = &quot;hello&quot;;
    console.log(x);
    //          ^?
  } else {
    x = 100;
    console.log(x);
    //          ^?
  }

  return x;
  //     ^?
}
</code></pre><h2 id="using-type-predicates">Using type predicates</h2>
<p>We&apos;ve worked with existing JavaScript constructs to handle narrowing so far, however sometimes you want more direct control over how types change throughout your code.</p>
<p>To define a user-defined type guard, we simply need to define a function whose return type is a <em>type predicate</em>:</p>
<p>```ts twoslash
type Fish = { swim: () =&gt; void };
type Bird = { fly: () =&gt; void };
declare function getSmallPet(): Fish | Bird;
// ---cut---
function isFish(pet: Fish | Bird): pet is Fish {
  return (pet as Fish).swim !== undefined;
}</p>
<pre class="language-"><code>
`pet is Fish` is our type predicate in this example.
A predicate takes the form `parameterName is Type`, where `parameterName` must be the name of a parameter from the current function signature.

Any time `isFish` is called with some variable, TypeScript will _narrow_ that variable to that specific type if the original type is compatible.

```ts twoslash
type Fish = { swim: () =&gt; void };
type Bird = { fly: () =&gt; void };
declare function getSmallPet(): Fish | Bird;
function isFish(pet: Fish | Bird): pet is Fish {
  return (pet as Fish).swim !== undefined;
}
// ---cut---
// Both calls to &apos;swim&apos; and &apos;fly&apos; are now okay.
let pet = getSmallPet();

if (isFish(pet)) {
  pet.swim();
} else {
  pet.fly();
}
</code></pre><p>Notice that TypeScript not only knows that <code>pet</code> is a <code>Fish</code> in the <code>if</code> branch;
it also knows that in the <code>else</code> branch, you <em>don&apos;t</em> have a <code>Fish</code>, so you must have a <code>Bird</code>.</p>
<p>You may use the type guard <code>isFish</code> to filter an array of <code>Fish | Bird</code> and obtain an array of <code>Fish</code>:</p>
<p>```ts twoslash
type Fish = { swim: () =&gt; void; name: string };
type Bird = { fly: () =&gt; void; name: string };
declare function getSmallPet(): Fish | Bird;
function isFish(pet: Fish | Bird): pet is Fish {
  return (pet as Fish).swim !== undefined;
}
// ---cut---
const zoo: (Fish | Bird)[] = [getSmallPet(), getSmallPet(), getSmallPet()];
const underWater1: Fish[] = zoo.filter(isFish);
// or, equivalently
const underWater2: Fish[] = zoo.filter(isFish) as Fish[];</p>
<p>// The predicate may need repeating for more complex examples
const underWater3: Fish[] = zoo.filter((pet): pet is Fish =&gt; {
  if (pet.name === &quot;sharkey&quot;) return false;
  return isFish(pet);
});</p>
<pre class="language-"><code>
In addition, classes can [use `this is Type`](/docs/handbook/2/classes.html#this-based-type-guards) to narrow their type.

# Discriminated unions

Most of the examples we&apos;ve looked at so far have focused around narrowing single variables with simple types like `string`, `boolean`, and `number`.
While this is common, most of the time in JavaScript we&apos;ll be dealing with slightly more complex structures.

For some motivation, let&apos;s imagine we&apos;re trying to encode shapes like circles and squares.
Circles keep track of their radiuses and squares keep track of their side lengths.
We&apos;ll use a field called `kind` to tell which shape we&apos;re dealing with.
Here&apos;s a first attempt at defining `Shape`.

```ts twoslash
interface Shape {
  kind: &quot;circle&quot; | &quot;square&quot;;
  radius?: number;
  sideLength?: number;
}
</code></pre><p>Notice we&apos;re using a union of string literal types: <code>&quot;circle&quot;</code> and <code>&quot;square&quot;</code> to tell us whether we should treat the shape as a circle or square respectively.
By using <code>&quot;circle&quot; | &quot;square&quot;</code> instead of <code>string</code>, we can avoid misspelling issues.</p>
<p>```ts twoslash
// @errors: 2367
interface Shape {
  kind: &quot;circle&quot; | &quot;square&quot;;
  radius?: number;
  sideLength?: number;
}</p>
<p>// ---cut---
function handleShape(shape: Shape) {
  // oops!
  if (shape.kind === &quot;rect&quot;) {
    // ...
  }
}</p>
<pre class="language-"><code>
We can write a `getArea` function that applies the right logic based on if it&apos;s dealing with a circle or square.
We&apos;ll first try dealing with circles.

```ts twoslash
// @errors: 2532
interface Shape {
  kind: &quot;circle&quot; | &quot;square&quot;;
  radius?: number;
  sideLength?: number;
}

// ---cut---
function getArea(shape: Shape) {
  return Math.PI * shape.radius ** 2;
}
</code></pre><!-- TODO -->
<p>Under <code>strictNullChecks</code> that gives us an error - which is appropriate since <code>radius</code> might not be defined.
But what if we perform the appropriate checks on the <code>kind</code> property?</p>
<p>```ts twoslash
// @errors: 2532
interface Shape {
  kind: &quot;circle&quot; | &quot;square&quot;;
  radius?: number;
  sideLength?: number;
}</p>
<p>// ---cut---
function getArea(shape: Shape) {
  if (shape.kind === &quot;circle&quot;) {
    return Math.PI <em> shape.radius *</em> 2;
  }
}</p>
<pre class="language-"><code>
Hmm, TypeScript still doesn&apos;t know what to do here.
We&apos;ve hit a point where we know more about our values than the type checker does.
We could try to use a non-null assertion (a `!` after `shape.radius`) to say that `radius` is definitely present.

```ts twoslash
interface Shape {
  kind: &quot;circle&quot; | &quot;square&quot;;
  radius?: number;
  sideLength?: number;
}

// ---cut---
function getArea(shape: Shape) {
  if (shape.kind === &quot;circle&quot;) {
    return Math.PI * shape.radius! ** 2;
  }
}
</code></pre><p>But this doesn&apos;t feel ideal.
We had to shout a bit at the type-checker with those non-null assertions (<code>!</code>) to convince it that <code>shape.radius</code> was defined, but those assertions are error-prone if we start to move code around.
Additionally, outside of <code>strictNullChecks</code> we&apos;re able to accidentally access any of those fields anyway (since optional properties are just assumed to always be present when reading them).
We can definitely do better.</p>
<p>The problem with this encoding of <code>Shape</code> is that the type-checker doesn&apos;t have any way to know whether or not <code>radius</code> or <code>sideLength</code> are present based on the <code>kind</code> property.
We need to communicate what <em>we</em> know to the type checker.
With that in mind, let&apos;s take another swing at defining <code>Shape</code>.</p>
<p>```ts twoslash
interface Circle {
  kind: &quot;circle&quot;;
  radius: number;
}</p>
<p>interface Square {
  kind: &quot;square&quot;;
  sideLength: number;
}</p>
<p>type Shape = Circle | Square;</p>
<pre class="language-"><code>
Here, we&apos;ve properly separated `Shape` out into two types with different values for the `kind` property, but `radius` and `sideLength` are declared as required properties in their respective types.

Let&apos;s see what happens here when we try to access the `radius` of a `Shape`.

```ts twoslash
// @errors: 2339
interface Circle {
  kind: &quot;circle&quot;;
  radius: number;
}

interface Square {
  kind: &quot;square&quot;;
  sideLength: number;
}

type Shape = Circle | Square;

// ---cut---
function getArea(shape: Shape) {
  return Math.PI * shape.radius ** 2;
}
</code></pre><p>Like with our first definition of <code>Shape</code>, this is still an error.
When <code>radius</code> was optional, we got an error (only in <code>strictNullChecks</code>) because TypeScript couldn&apos;t tell whether the property was present.
Now that <code>Shape</code> is a union, TypeScript is telling us that <code>shape</code> might be a <code>Square</code>, and <code>Square</code>s don&apos;t have <code>radius</code> defined on them!
Both interpretations are correct, but only does our new encoding of <code>Shape</code> still cause an error outside of <code>strictNullChecks</code>.</p>
<p>But what if we tried checking the <code>kind</code> property again?</p>
<p>```ts twoslash
interface Circle {
  kind: &quot;circle&quot;;
  radius: number;
}</p>
<p>interface Square {
  kind: &quot;square&quot;;
  sideLength: number;
}</p>
<p>type Shape = Circle | Square;</p>
<p>// ---cut---
function getArea(shape: Shape) {
  if (shape.kind === &quot;circle&quot;) {
    return Math.PI <em> shape.radius *</em> 2;
    //               ^?
  }
}</p>
<pre class="language-"><code>
That got rid of the error!
When every type in a union contains a common property with literal types, TypeScript considers that to be a _discriminated union_, and can narrow out the members of the union.

In this case, `kind` was that common property (which is what&apos;s considered a _discriminant_ property of `Shape`).
Checking whether the `kind` property was `&quot;circle&quot;` got rid of every type in `Shape` that didn&apos;t have a `kind` property with the type `&quot;circle&quot;`.
That narrowed `shape` down to the type `Circle`.

The same checking works with `switch` statements as well.
Now we can try to write our complete `getArea` without any pesky `!` non-null assertions.

```ts twoslash
interface Circle {
  kind: &quot;circle&quot;;
  radius: number;
}

interface Square {
  kind: &quot;square&quot;;
  sideLength: number;
}

type Shape = Circle | Square;

// ---cut---
function getArea(shape: Shape) {
  switch (shape.kind) {
    case &quot;circle&quot;:
      return Math.PI * shape.radius ** 2;
    //                 ^?
    case &quot;square&quot;:
      return shape.sideLength ** 2;
    //       ^?
  }
}
</code></pre><p>The important thing here was the encoding of <code>Shape</code>.
Communicating the right information to TypeScript - that <code>Circle</code> and <code>Square</code> were really two separate types with specific <code>kind</code> fields - was crucial.
Doing that let us write type-safe TypeScript code that looks no different than the JavaScript we would&apos;ve written otherwise.
From there, the type system was able to do the &quot;right&quot; thing and figure out the types in each branch of our <code>switch</code> statement.</p>
<blockquote>
<p>As an aside, try playing around with the above example and remove some of the return keywords.
You&apos;ll see that type-checking can help avoid bugs when accidentally falling through different clauses in a <code>switch</code> statement.</p>
</blockquote>
<p>Discriminated unions are useful for more than just talking about circles and squares.
They&apos;re good for representing any sort of messaging scheme in JavaScript, like when sending messages over the network (client/server communication), or encoding mutations in a state management framework.</p>
<h1 id="the-never-type">The <code>never</code> type</h1>
<p>When narrowing, you can reduce the options of a union to a point where you have removed all possibilities and have nothing left.
In those cases, TypeScript will use a <code>never</code> type to represent a state which shouldn&apos;t exist.</p>
<h1 id="exhaustiveness-checking">Exhaustiveness checking</h1>
<p>The <code>never</code> type is assignable to every type; however, no type is assignable to <code>never</code> (except <code>never</code> itself). This means you can use narrowing and rely on <code>never</code> turning up to do exhaustive checking in a switch statement.</p>
<p>For example, adding a <code>default</code> to our <code>getArea</code> function which tries to assign the shape to <code>never</code> will raise when every possible case has not been handled.</p>
<p>```ts twoslash
interface Circle {
  kind: &quot;circle&quot;;
  radius: number;
}</p>
<p>interface Square {
  kind: &quot;square&quot;;
  sideLength: number;
}
// ---cut---
type Shape = Circle | Square;</p>
<p>function getArea(shape: Shape) {
  switch (shape.kind) {
    case &quot;circle&quot;:
      return Math.PI <em> shape.radius <em>* 2;
    case &quot;square&quot;:
      return shape.sideLength </em></em> 2;
    default:
      const _exhaustiveCheck: never = shape;
      return _exhaustiveCheck;
  }
}</p>
<pre class="language-"><code>
Adding a new member to the `Shape` union, will cause a TypeScript error:

```ts twoslash
// @errors: 2322
interface Circle {
  kind: &quot;circle&quot;;
  radius: number;
}

interface Square {
  kind: &quot;square&quot;;
  sideLength: number;
}
// ---cut---
interface Triangle {
  kind: &quot;triangle&quot;;
  sideLength: number;
}

type Shape = Circle | Square | Triangle;

function getArea(shape: Shape) {
  switch (shape.kind) {
    case &quot;circle&quot;:
      return Math.PI * shape.radius ** 2;
    case &quot;square&quot;:
      return shape.sideLength ** 2;
    default:
      const _exhaustiveCheck: never = shape;
      return _exhaustiveCheck;
  }
}
</code></pre>
                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="More on Functions.html" class="navigation navigation-prev " aria-label="Previous page: More On Functions">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="Object Types.html" class="navigation navigation-next " aria-label="Next page: Object Types">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Narrowing","layout":"docs","permalink":"/docs/handbook/2/narrowing.html","oneline":"Understand how TypeScript uses JavaScript knowledge to reduce the amount of type syntax in your projects.","level":"1.4.7","depth":2,"next":{"title":"Object Types","level":"1.4.8","depth":2,"path":"handbook-v2/Object Types.md","ref":"handbook-v2/Object Types.md","articles":[]},"previous":{"title":"More On Functions","level":"1.4.6","depth":2,"path":"handbook-v2/More on Functions.md","ref":"handbook-v2/More on Functions.md","articles":[]},"dir":"ltr"},"config":{"plugins":["-sharing","-highlight","-livereload","prism"],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"prism":{"css":["prismjs/themes/prism-solarizedlight.css"]},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"title":"TypeScript 英文文档","language":"us-en","links":{"sidebar":{"Home":"https://docs.khs1994.com"}},"gitbook":"*"},"file":{"path":"handbook-v2/Narrowing.md","mtime":"2021-05-19T00:40:23.000Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2021-05-19T00:41:42.790Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

